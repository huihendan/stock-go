# 回测模块设计

## 需求
1. 通过回测模块，验证各种策略的效果。根据策略结果，进行股票买卖，检验最终盈亏数据。

## 关键结构体

### 钱包 (Wallet)
```go
// 钱包（总资产）
type Wallet struct {
    Cash      float64     // 现金
    Positions []Position  // 持仓
}
```

### 仓位 (Position)
```go
// 仓位
type Position struct {
    StockCode  string  // 股票代码
    StockName  string  // 股票名称
    StockNum   int     // 股票数量
    Profit     float64 // 盈利
    BuyPrice   float64 // 买入价格
    SellPrice  float64 // 卖出价格
    BuyDate    string  // 操作日期
}
```

### 操作 (Operate)
```go
// 操作
type Operate struct {
    OperateType int     // 操作类型：买入、卖出
    BuyPrice    float64 // 买入价格
    SellPrice   float64 // 卖出价格
    OperateDate string  // 操作日期
    OperateTime string  // 操作时间
    StockCode   string  // 股票代码
    StockName   string  // 股票名称
    StockNum    int     // 股票数量
}
```

### 操作记录 (OperateRecord)
```go
// 操作记录
type OperateRecord struct {
    StockCode    string   // 股票代码
    StockName    string   // 股票名称
    StockNum     float64  // 股票数量
    BuyOperate   Operate  // 买入操作
    SellOperate  Operate  // 卖出操作
    Status       int      // 当前状态：1-买入持仓中 2-已卖出
    Profit       float64  // 盈利
    OperateDate  string   // 操作日期
    OperateTime  string   // 操作时间
}
```

## 核心函数

### tradeTest
传入单个股票代码，对股票历史数据进行回测。内部遍历传入股票每天的数据，根据策略计算是否需要买入卖出。最后计算盈亏，并且返回操作记录。

```go
func tradeTest(code string, strategyMode int, wallet Wallet) (Wallet, []OperateRecord)
```

#### 参数说明
- `code`: 股票代码
- `strategyMode`: 策略模式
- `wallet`: 钱包（总资产）

#### 返回值
- `Wallet`: 更新后的钱包
- `[]OperateRecord`: 操作记录列表

